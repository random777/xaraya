<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
	<TITLE>Calling Hooks</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.2  (Linux)">
	<META NAME="CREATED" CONTENT="20040815;10451900">
	<META NAME="CHANGEDBY" CONTENT="Scot Gardner">
	<META NAME="CHANGED" CONTENT="20040815;10451900">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin-left: 1.25in; margin-right: 1.25in; margin-top: 0.5in; margin-bottom: 0.5in }
		P { margin-bottom: 0.08in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-US }
		P.cjk { font-family: "Times New Roman", serif; font-size: 12pt; so-language:  }
		P.ctl { font-family: "Times New Roman", serif; font-size: 10pt }
		H1 { margin-left: -0.25in; margin-bottom: 0.04in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		H1.western { font-family: "Arial", sans-serif; font-size: 16pt; so-language: en-US }
		H1.cjk { font-family: "Times New Roman", serif; font-size: 16pt; so-language:  }
		H1.ctl { font-family: "Times New Roman", serif; font-size: 10pt; font-weight: medium }
		A:link { color: #000000 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" TEXT="#000000" LINK="#000000" DIR="LTR">
<DIV TYPE=HEADER>
	<P ALIGN=RIGHT STYLE="margin-bottom: 0in">Scot Gardner <SDFIELD TYPE=PAGE SUBTYPE=RANDOM FORMAT=PAGE></SDFIELD></P>
	<P STYLE="margin-bottom: 0.3in"><BR>
	</P>
</DIV>
<UL>
	<LI><H1 CLASS="western" STYLE="page-break-inside: auto">Calling
	Hooks</H1>
</UL>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">	You are developing an item module then you
should allow utility modules to add functionality to the item module.
This is carried out through use of the <FONT SIZE=2><FONT FACE="Courier New, monospace">xarModCallHooks()</FONT></FONT>
function. This function placed wherever a specific action is required
by the item module, where the current specific actions that the hooks
system is able to operate on are: </FONT>
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">	The hook calls made at the appropriate level
depending on the action taken. With the current hooks, addition and
deletion hooks called at the <B>API</B> level, and display hooks
called at the <B>GUI</B> level. </FONT>
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">The <FONT SIZE=2><FONT FACE="Courier New, monospace">xarModCallHooks()</FONT></FONT>
function takes a number of parameters, which are explained below: </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
hookobject 
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">The object for which the hooks are called -
currently either <I>category</I>, or <I>item</I>, as described above </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
hookaction 
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">The action for which the hooks are to be called
- currently one of <I>create</I>, <I>delete</I>, <I>transform</I>, or
<I>display</I> </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
obid 
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
An ID that, within the scope of the module and object, uniquely
defines the entity for which the hook is called 
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
extrainfo 
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
This is extra information that is required by the hook function, and
is dependent on the hook action being called. Information on the
information required by each hook is covered below. 
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">For <FONT SIZE=2><FONT FACE="Courier New, monospace">create</FONT></FONT>
hooks a string that can be used in conjunction with the obid as part
of a URL to access the object. For example, if your
<FONT SIZE=2><FONT FACE="Courier New, monospace">example_user_display()</FONT></FONT>
function uses a variable <I>picid</I> to define the particular
picture that a user wishes to look at then the URL would be something
like 'index.php?module=example&amp;func=display&amp;picid=4' and the
identification part of the URL would be something like 'picid=4' so
you would pass 'picid' to this hook. </FONT>
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">For <FONT SIZE=2><FONT FACE="Courier New, monospace">display()</FONT></FONT>
hooks a URL that can be used by the hooks to return to a suitable
page once they have finished any work that they might have to do.
This is normally just the standard display URL for this function. </FONT>
</P>
<P CLASS="western" STYLE="margin-left: 0.5in; margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">For <FONT SIZE=2><FONT FACE="Courier New, monospace">transform()</FONT></FONT>
hooks an array of items that contain text-based content that can be
transformed. This is normally all text-based items. </FONT>
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
<FONT COLOR="#000000">	The <FONT SIZE=2><FONT FACE="Courier New, monospace">xarModCallHooks()</FONT></FONT>
function returns different information depending on value of
<I>hookaction</I>. If <I>hookaction</I> is <I>display</I> then the
hook will return extra output to display directly following the
display for the item itself. If <I>hookaction</I> is <I>create</I> or
<I>delete</I> then the function will return either <I>true</I> or
<I>false</I> depending on the success or failure of the hooks. If
<I>hookaction</I> is <I>transform</I> then the hook will return an
equivalent array to that which was passed in, with the items suitable
transformed. </FONT>
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
	As an example of calling hooks, if you were developing the 'Example'
module and were displaying a picture, after the display of the
picture you would want to call the hooks to add any other
functionality available and required by the site administrator. To do
this you would use the following lines: 
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
<FONT SIZE=2 STYLE="font-size: 9pt"><FONT FACE="Courier New, monospace"><FONT COLOR="#800000">$output</FONT><FONT COLOR="#000000">-&gt;Text(xarModCallHooks(</FONT><FONT COLOR="#008000">'item'</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                            </FONT><FONT COLOR="#008000">'display'</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                            </FONT><FONT COLOR="#800000">$pictureid</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                            </FONT><FONT COLOR="#000000">xarModURL(</FONT><FONT COLOR="#008000">'example'</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                                     </FONT><FONT COLOR="#008000">'user'</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                                     </FONT><FONT COLOR="#008000">'display'</FONT><FONT COLOR="#000000">,<BR></FONT><FONT COLOR="#008080">
                                     </FONT><FONT COLOR="#000000"><B>array</B>(</FONT><FONT COLOR="#008000">'pictureid'</FONT><FONT COLOR="#008080">
</FONT><FONT COLOR="#000000">=&gt;</FONT><FONT COLOR="#008080">
</FONT><FONT COLOR="#800000">$pictureid</FONT><FONT COLOR="#000000">))));</FONT></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
        
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
	This would add the verbatim output of the hooks to the current
output. It is worth noting again here the from this code it can be
seen that the module itself needs no information on what hooks, if
any, exist, it just calls the function and lets the Xaraya core deal
with what extra output should be added to this item. 
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
	One important area to understand is where exactly in your code to
call hooks. For example, if you were displaying a thumbnail view of
100 pictures from your Example module, should you call an item
display hook for each picture? The answer to this is somewhat
dependent on the nature of your module. In general you should only
call display hooks when you are displaying the details of a single
item rather than an overview of a large number of items (of course,
if all of those items are in a single category then you should call a
display hook for that category). However, the transform hook should
be called whenever you are displaying content regardless of it if is
just an overview, as the overview information could require
transformation before display. 
</P>
<P CLASS="western" STYLE="margin-top: 0.07in; margin-bottom: 0.07in; page-break-inside: auto">
	The annotated Example module in the standard Xaraya distribution
contains notes on calling hooks within an item module. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: auto">
<BR>
</P>
<DIV TYPE=FOOTER>
	<P ALIGN=CENTER STYLE="margin-top: 0.29in; margin-bottom: 0in"><FONT SIZE=2>All
	boldface terms are defined in the Glossary beginning on page 42</FONT></P>
</DIV>
</BODY>
</HTML>