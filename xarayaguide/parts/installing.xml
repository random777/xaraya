<?xml version="1.0" encoding="UTF-8"?>
<chapter id="installing">
  <title>Installing Xaraya</title>

  <para>Once Xaraya has been moved onto your site (either via a copy command
  or an upload), you must install it before using the site. The most uptodate
  install guide can be viewed online at the Xaraya website. <ulink
  url="http://www.xaraya.com/index.php/documentation/97">http://www.xaraya.com/index.php/documentation/97</ulink>
  is the official installation guide. In this chapter, we give a short
  overview on the installation procedures which might not be the most up to
  date one.<note>
      <para>If you are a Windows user and also use ZoneAlarm, be sure to
      DISABLE or EXIT ZoneAlarm before installing Xaraya on a Windows machine.
      ZoneAlarm may cause problems when installing Xaraya on a Windows
      machine.</para>
    </note></para>

  <sect1 id="install-guide">
    <title>Installation Guide</title>

    <para>From your browser, launch
    http://www.mywebsite.com/xaraya/install.php (replace with the correct path
    to your Xaraya installation's "<filename>install.php</filename>"
    file).</para>

    <sect2 id="install-language">
      <title>Choose a Language</title>

      <para>Select your language from the drop-down list. Click
      "<guibutton>Continue</guibutton>".</para>

      <figure id="install-languagefig">
        <title>Language selection.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install01.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>
    </sect2>

    <sect2 id="install-license">
      <title>License Acceptance</title>

      <para>Read &amp; agree to the license. Click
      "<guibutton>Continue</guibutton>". If you do not agree to the license,
      you cannot install Xaraya.</para>

      <figure id="install-licensefig">
        <title>Xaraya license agreement</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install02.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>
    </sect2>

    <sect2 id="install-check">
      <title>System Settings Check: PHP and directories</title>

      <para>This panel tells you if you have set up Xaraya correctly. It runs
      checks and determines whether you're running the correct version of PHP
      and whether the permissions are set correctly, and more. If there is a
      problem then follow the advice given. If no failures or warnings are
      reported, click "<guibutton>Continue</guibutton>". If an error or
      problem is reported, fix it before continuing. Once you have fixed any
      issues, press "<guibutton>Check Again</guibutton>" to re-check the
      system settings.</para>

      <figure id="install-checkfig1">
        <title>System Settings Check, part 1.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install03_a.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>FAILURE: PHP Version is less than
          4.1.2.</emphasis></para>

          <para>This error can be fixed by installing an updated version of
          PHP that is equal to or greater than version 4.1.2.</para>
        </listitem>

        <listitem>
          <para><emphasis>FAILURE: The installer cannot write to the
          configuration file. Please verify that your webserver has write
          access to the var/config.system.php file.</emphasis></para>

          <para>This error can be fixed by changing the permissions of the
          &lt;xarroot&gt;/var/config.system.php" file, for example,
          "<userinput>chmod 660
          &lt;xarroot&gt;/var/config.system.php</userinput>" if you use SSH to
          your install. If you use an FTP client to get your files onto the
          server, you can normally change the permissions on this file using
          that client. Make sure the user and group has write access to the
          config file during installation.</para>
        </listitem>

        <listitem>
          <para><emphasis>FAILURE: The installer cannot write to
          var/cache/templates. Please verify that your webserver has write
          access to the var/cache/templates directory.</emphasis></para>

          <para>This error can be fixed by changing the permissions of the
          &lt;xarroot&gt;/var/cache/templates" directory, for example,
          "<userinput>chmod 770
          &lt;xarroot&gt;/var/cache/templates</userinput>".</para>
        </listitem>

        <listitem>
          <para><emphasis>FAILURE: The installer cannot write to the
          var/cache/rss directory.</emphasis></para>

          <para>This error can be fixed by changing the permissions of the
          &lt;xarroot&gt;/var/cache/rss" directory, for example,
          "<userinput>chmod 770
          &lt;xarroot&gt;/var/cache/rss</userinput>".</para>
        </listitem>

        <listitem>
          <para><emphasis>FAILURE: The installer cannot write to the
          var/cache/adodb directory.</emphasis></para>

          <para>This error can be fixed by changing the permissions of the
          &lt;xarroot&gt;/var/cache/adodb" directory, for example,
          "<userinput>chmod 770
          &lt;xarroot&gt;/var/cache/adodb</userinput>".</para>
        </listitem>
      </itemizedlist>
    </sect2>

    <sect2>
      <title>System Settings Check: databases</title>

      <para>On the same panel as the PHP checks you can see the results from
      the database check. Xaraya is a system that needs a database to store
      the content and settings. You have a wide choice of databases you can
      choose from. The installer checks that you have at least on database
      connection available.</para>

      <figure id="install-checkfig2">
        <title>System Settings Check, part 2.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install03_b.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para>Warning: you do not have a supported database type available.
          This warning means that Xaraya has not reckognised your database
          type. You can continue to the next step, but you will have to edit
          the database connection settings manually in the config.system.php
          file.</para>

          <para>You are advised to modify your server environment as such that
          you will have at least one of the mentioned databases available. If
          this is true, you will get a green light from the installer:</para>

          <figure id="install-checkfig3">
            <title>System Settings Check, part 3.</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="sourceimages/install03_c.jpg" format="JPG" />
              </imageobject>
            </mediaobject>
          </figure>
        </listitem>
      </itemizedlist>
    </sect2>

    <sect2 id="install-database">
      <title>Database Settings</title>

      <para>Review (and edit if necessary) the Database Settings on the next
      panel. The default database settings displayed on this panel come from
      the 'config.system.php' file we edited above.</para>

      <figure id="install-databasefig">
        <title>Database Settings Collection.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install06.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para>The database types currently supported by Xaraya are MySQL or
          PostgreSQL. Choose the one that you are using.</para>
        </listitem>

        <listitem>
          <para>Click "<guibutton>Create the database</guibutton>" to have the
          Xaraya installer attempt to create the database. Click
          "<guibutton>Continue</guibutton>".</para>
        </listitem>
      </itemizedlist>

      <para>If Xaraya cannot create the database for you, see Appendix B:
      Creating the Xaraya database via phpMyAdmin.</para>

      <para>If you press continue, and you have already got your database
      available, you will see a warning that the installer will overwrite all
      tables present that have the same prefix:</para>

      <figure id="install-adminfig">
        <title>Xaraya has encountered a database.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install08.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>Normally, you should be able to continue, to the initialisation
      phase:</para>

      <figure id="install-adminfig2">
        <title>Start of initialisation</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install07.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>
    </sect2>

    <sect2 id="install-admin">
      <title>Administrator Account Creation</title>

      <para>This panel creates the site Administrator's account. This account
      has unlimited access to the site and is used to control the site.</para>

      <figure id="install-adminfig3">
        <title>Administrator Account Creation</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install09.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para>Enter Full Name -- the Administrator's full name.</para>
        </listitem>

        <listitem>
          <para>Enter Username -- (<emphasis>required</emphasis>) used by the
          Administrator to log into the site. It is strongly advised to keep
          this to 'admin'.</para>
        </listitem>

        <listitem>
          <para>Enter Password -- (<emphasis>required</emphasis>) used by the
          Administrator to log into the site.</para>
        </listitem>

        <listitem>
          <para>Enter Password again to verify
          (<emphasis>required</emphasis>).</para>
        </listitem>

        <listitem>
          <para>Enter Administrator Email address
          (<emphasis>required</emphasis>).</para>
        </listitem>

        <listitem>
          <para>Click "<guibutton>Continue</guibutton>".</para>
        </listitem>
      </itemizedlist>
    </sect2>

    <sect2 id="install-config">
      <title>Available Configurations</title>

      <figure id="install-configfig">
        <title>Available Configurations</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install10.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para>'<guibutton>Community Site</guibutton>' prepares a site where
          Registered users have read access to all modules and Anonymous users
          can either read non-core modules or be limited essentially to the
          first panel (depending on the configuration option selected at
          installation).</para>
        </listitem>

        <listitem>
          <para>'<guibutton>Intranet</guibutton>' configuration is very
          restrictive where users who aren't logged in (Anonymous users) are
          limited to the first panel. Registered users have read access to
          non-core modules. There is also another group of users called
          'Oversight' that have Administrative rights to everything except the
          Roles and Privileges modules.</para>
        </listitem>

        <listitem>
          <para>'<guibutton>Public</guibutton>' assumes a site where Anonymous
          users can do more than just read. They have the option to post
          comments to articles in non-core modules, while Registered users can
          be given moderate rights to all modules.</para>
        </listitem>

        <listitem>
          <para>'<guibutton>Core</guibutton>' is the minimal install. This
          install will only install the necessary parts to get Xaraya
          running.</para>
        </listitem>
      </itemizedlist>

      <para>From the list of Available Configurations, select
      "<command>Community Site</command>". Click
      "<command>Continue</command>".</para>
    </sect2>

    <sect2 id="install-configoptions">
      <title>Choose Configuration Options</title>

      <para>Once you've chosen your configuration from the Available
      Configurations, specify which modules you wish to initialise via the
      installer. The listed modules are a subset of all the modules available
      for Xaraya, but this provides a nice starting place. For this example,
      select the installation defaults unless you have specific reasons to
      select otherwise.</para>

      <figure id="install-configoptionsfig">
        <title>Choose Configuration Options</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install11.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>If you make a mistake or forget to install a module that you need,
      don't worry -- modules can be installed or removed at any time.</para>
    </sect2>

    <sect2 id="install-complete">
      <title>Installation Complete</title>

      <para>Click "<command>Continue</command>".</para>

      <figure id="install-completefig">
        <title>Installation complete!</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="sourceimages/install12.jpg" format="JPG" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>Your Xaraya installation is complete! Click "<command>Launch the
      site!</command>" to go to your new Xaraya website, logged in as the
      Administrator.</para>
    </sect2>
  </sect1>

  <sect1 id="security">
    <title>Increase site security</title>

    <para>There are two steps that are recommended after installation to
    increase the security of the website.</para>

    <orderedlist>
      <listitem>
        <para>To increase site security after installation, delete the
        '<filename>install.php</filename>' and
        '<filename>upgrade.php</filename>' files from the Xaraya installation
        directory ("&lt;xarroot&gt;"). These two files are not needed for
        normal site operation. For example, on Linux:</para>

        <itemizedlist>
          <listitem>
            <para>"<userinput>cd &lt;xarroot&gt;</userinput>"</para>
          </listitem>

          <listitem>
            <para>"<userinput>rm install.php</userinput>"</para>
          </listitem>

          <listitem>
            <para>"<userinput>rm upgrade.php</userinput>"</para>
          </listitem>
        </itemizedlist>
      </listitem>

      <listitem>
        <para>Change the file permissions for
        <filename>&lt;xarroot&gt;/var/config.system.php</filename> to "444"
        (read-only). This can be done by using the command "<userinput>chmod
        444 config.system.php</userinput>" from within the Xaraya's
        <filename>/var</filename> directory. For example, on Linux:</para>

        <itemizedlist>
          <listitem>
            <para>"<userinput>cd &lt;xarroot&gt;/va</userinput>r"</para>
          </listitem>

          <listitem>
            <para>"<userinput>chmod 444 config.system.php</userinput>"</para>
          </listitem>
        </itemizedlist>
      </listitem>
    </orderedlist>
  </sect1>

  <sect1 id="interface">
    <title>A Quick Look at Xaraya's Interface</title>

    <para>After the first installation, Xaraya's interface is presented with
    the Xaraya Classic theme. This theme is shipped with every package and is
    meant as a start for your new website.</para>

    <figure id="install-postinstall">
      <title>Xaraya's interface after installation.</title>

      <mediaobject>
        <imageobject>
          <imagedata fileref="sourceimages/firstglance.jpg" format="JPG" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>At the top is the title bar of the browser which says, "Your Site
    Name :: Base :: Welcome" by default (not in the figure). Below that, at
    the top left of the screen, is the Xaraya logo which is part of the
    '<firstterm>header</firstterm>' region. Click the logo at any time to go
    to the front page of your site. To the right you see the sentence "Your
    Site Slogan". This is the configurable site slogan that you can
    set.</para>

    <para>Down the left side, since you're logged in as an Administrator,
    appears the Administration menu which may be divided into groups (Global,
    Content, Users &amp; Groups, etc.) depending on your configuration
    selection in Admin-&gt;Adminpanels-&gt;Modify config. The Administration
    menu appears only for members of the Administrator group; regular users
    (anonymous and registered users) do not see this menu. </para>

    <para>The first item in the menu is called "Help". This title is available
    to admins at any page and will redirect you to the help page for the
    current function. At the bottom of the Administration menu there can be
    the "[admin logout]" link which should be used to log out of the site when
    you're done administrating Xaraya. This link is not shown by default.
    Above the Administration menu is the Main Menu. This Main Menu has items
    that can be shown to regular users. The number of items normal users can
    see depend on their privileges. You, as the current administrator, will be
    able to see all items.</para>

    <figure>
      <title>Xaraya's standard footer</title>

      <mediaobject>
        <imageobject>
          <imagedata entityref="footer" fileref="sourceimages/footer.jpg" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>At the bottom of the browser window is Xaraya's
    '<firstterm>footer</firstterm>' region. After installation, you'll see the
    Copyright statement, CSS tableless design button (click it to check the
    theme for true tableless design), the xhtml button, the CSS validator
    button and the "powered by Xaraya" logo.</para>

    <para>The large pane that uses most of the browser window is the content
    region. This is where the majority of site information is displayed to
    users. The first line of the first large text block shows you the version
    of Xaraya you use (1.1.3 in the image).</para>

    <para>Everything you see in Xaraya is configurable. Xaraya's powerful
    theming engine, BlockLayout, makes it easy to customize your site to your
    exact specifications. The colors, the fonts, the placement of information
    is all configurable by changing themes or templates on your Xaraya site.
    Don't like the Administration menu on the left? It's quite simple to move
    it. Want to put your own logo in place of the Xaraya logo at the top? No
    problem! Read on to learn how!</para>
  </sect1>

  <sect1 id="clickpaths">
    <title>Click-Paths</title>

    <para>For the remainder of this document, we indicate where to click by
    using "<firstterm>click-paths</firstterm>".</para>

    <para>"Click-paths" are a series of clicks you make in your web browser.
    An example of a "click-path" is indicated as follows:</para>

    <para><command>Admin-&gt;Blocks-&gt;View Instances</command></para>

    <para>This example click-path instructs you that while logged in as the
    Administrator ('Admin'), click the link for Blocks and finally on the next
    page click 'View Instances'. Generally, the click-path is followed with a
    specific instruction, as you see in REMOVING THE REMINDER BLOCK,
    below.</para>
  </sect1>

  <sect1 id="reminder">
    <title>Removing the Reminder Block</title>

    <para>There is a REMINDER block that is displayed on the left side menu of
    a newly-installed or updated Xaraya site which reminds the Administrator
    to delete the install.php and upgrade.php files from
    <command>&lt;xarroot&gt;</command>. Since we've already deleted those
    files, we can safely remove the REMINDER block. Follow the steps below to
    remove the REMINDER block.</para>

    <itemizedlist>
      <listitem>
        <para><command>Admin-&gt;Blocks-&gt;View Instances</command>:</para>

        <itemizedlist>
          <listitem>
            <para>In the line with REMINDER in the title, click the
            "<command>Delete</command>" operation and "<command>OK</command>"
            to confirm deletion. The REMINDER block is deleted.</para>
          </listitem>
        </itemizedlist>
      </listitem>
    </itemizedlist>
  </sect1>
</chapter>